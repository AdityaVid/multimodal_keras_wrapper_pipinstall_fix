

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Documentation for the Code &mdash; staged_keras_wrapper 0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="staged_keras_wrapper 0.1 documentation" href="index.html"/>
        <link rel="prev" title="Welcome to Staged Keras Wrapper’s documentation!" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> staged_keras_wrapper
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Documentation for the Code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-Dataset">Dataset.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-CNN_Model">CNN_Model.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-Staged_Network">Staged_Network.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-Stage">Stage.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-ECOC_Classifier">ECOC_Classifier.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-Utils">Utils.py</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-ThreadLoader">ThreadLoader.py</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">staged_keras_wrapper</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Documentation for the Code</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/code.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="documentation-for-the-code">
<h1>Documentation for the Code<a class="headerlink" href="#documentation-for-the-code" title="Permalink to this headline">¶</a></h1>
<p>Documentation for the keras_wrapper module.</p>
<div class="section" id="module-Dataset">
<span id="dataset-py"></span><h2>Dataset.py<a class="headerlink" href="#module-Dataset" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="Dataset.Dataset">
<em class="property">class </em><code class="descclassname">Dataset.</code><code class="descname">Dataset</code><span class="sig-paren">(</span><em>name, path, silence=False, size=[256, 256, 3], size_crop=[227, 227, 3]</em><span class="sig-paren">)</span><a class="headerlink" href="#Dataset.Dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for defining instances of databases adapted for Keras. In includes several utility functions for easily managing
data splits, image loading, mean calculation, etc.</p>
<dl class="method">
<dt id="Dataset.Dataset.calculateTrainMean">
<code class="descname">calculateTrainMean</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Dataset.Dataset.calculateTrainMean" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the mean of the data belonging to the training set split in each channel.</p>
</dd></dl>

<dl class="method">
<dt id="Dataset.Dataset.getClassID">
<code class="descname">getClassID</code><span class="sig-paren">(</span><em>class_name</em><span class="sig-paren">)</span><a class="headerlink" href="#Dataset.Dataset.getClassID" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the class id (int) for a given class string.</p>
</dd></dl>

<dl class="method">
<dt id="Dataset.Dataset.getX">
<code class="descname">getX</code><span class="sig-paren">(</span><em>set_name</em>, <em>init</em>, <em>final</em>, <em>normalization=False</em>, <em>meanSubstraction=True</em>, <em>dataAugmentation=True</em><span class="sig-paren">)</span><a class="headerlink" href="#Dataset.Dataset.getX" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets all the data samples stored between the positions init to final</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>set_name</strong> &#8211; &#8216;train&#8217;, &#8216;val&#8217; or &#8216;test&#8217; set</li>
<li><strong>init</strong> &#8211; initial position in the corresponding set split. Must be bigger or equal than 0 and bigger than final.</li>
<li><strong>final</strong> &#8211; final position in the corresponding set split.</li>
<li><strong>normalization</strong> &#8211; indicates if we want to apply a 0-1 normalization on the images. If normalization then the images are stored in float32, else they are stored in int32</li>
<li><strong>meanSubstraction</strong> &#8211; indicates if we want to substract the training mean from the returned images (only applicable if normalization=True)</li>
<li><strong>dataAugmentation</strong> &#8211; indicates if we want to apply data augmentation to the loaded images (random flip and cropping)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Dataset.Dataset.getXY">
<code class="descname">getXY</code><span class="sig-paren">(</span><em>set_name</em>, <em>k</em>, <em>normalization=False</em>, <em>meanSubstraction=True</em>, <em>dataAugmentation=True</em><span class="sig-paren">)</span><a class="headerlink" href="#Dataset.Dataset.getXY" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the [X,Y] pairs for the next &#8216;k&#8217; samples in the desired set.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>set_name</strong> &#8211; &#8216;train&#8217;, &#8216;val&#8217; or &#8216;test&#8217; set</li>
<li><strong>k</strong> &#8211; number of consecutive samples retrieved from the corresponding set.</li>
<li><strong>normalization</strong> &#8211; indicates if we want to apply a 0-1 normalization on the images. If &#8216;normalization&#8217; == True then the images are stored in float32, else they are stored in int32</li>
<li><strong>meanSubstraction</strong> &#8211; indicates if we want to substract the training mean from the returned images (only applicable if normalization=True)</li>
<li><strong>dataAugmentation</strong> &#8211; indicates if we want to apply data augmentation to the loaded images (random flip and cropping)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Dataset.Dataset.loadImages">
<code class="descname">loadImages</code><span class="sig-paren">(</span><em>images</em>, <em>normalization=False</em>, <em>meanSubstraction=True</em>, <em>dataAugmentation=True</em>, <em>external=False</em>, <em>loaded=False</em><span class="sig-paren">)</span><a class="headerlink" href="#Dataset.Dataset.loadImages" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a set of images from disk.</p>
<p>:param images : list of image string names or list of matrices representing images
:param normalization : whether we applying a 0-1 normalization to the images
:param meanSubstraction : whether we are removing the training mean
:param dataAugmentation : whether we are applying dataAugmentatino (random cropping and horizontal flip)
:param external : if True the images will be loaded from an external database, in this case the list of images must be absolute paths
:param loaded : set this option to True if images is a list of matricies instead of a list of strings</p>
</dd></dl>

<dl class="method">
<dt id="Dataset.Dataset.resetCounters">
<code class="descname">resetCounters</code><span class="sig-paren">(</span><em>set_name='all'</em><span class="sig-paren">)</span><a class="headerlink" href="#Dataset.Dataset.resetCounters" title="Permalink to this definition">¶</a></dt>
<dd><p>Resets some basic counter indices for the next samples to read.</p>
</dd></dl>

<dl class="method">
<dt id="Dataset.Dataset.setClasses">
<code class="descname">setClasses</code><span class="sig-paren">(</span><em>path_classes</em><span class="sig-paren">)</span><a class="headerlink" href="#Dataset.Dataset.setClasses" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the list of classes of the dataset.
Each line must contain a unique identifier of the class.</p>
</dd></dl>

<dl class="method">
<dt id="Dataset.Dataset.setImageSize">
<code class="descname">setImageSize</code><span class="sig-paren">(</span><em>size</em><span class="sig-paren">)</span><a class="headerlink" href="#Dataset.Dataset.setImageSize" title="Permalink to this definition">¶</a></dt>
<dd><p>Changes the default image return size.</p>
</dd></dl>

<dl class="method">
<dt id="Dataset.Dataset.setImageSizeCrop">
<code class="descname">setImageSizeCrop</code><span class="sig-paren">(</span><em>size_crop</em><span class="sig-paren">)</span><a class="headerlink" href="#Dataset.Dataset.setImageSizeCrop" title="Permalink to this definition">¶</a></dt>
<dd><p>Changes the default image return size.</p>
</dd></dl>

<dl class="method">
<dt id="Dataset.Dataset.setLabels">
<code class="descname">setLabels</code><span class="sig-paren">(</span><em>labels_list</em>, <em>set_name</em><span class="sig-paren">)</span><a class="headerlink" href="#Dataset.Dataset.setLabels" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a set of int labels referencing values in self.classes (starting from 0)
&#8216;labels_list&#8217; can either be a path to a .txt file containing the labels or a python list of labels</p>
</dd></dl>

<dl class="method">
<dt id="Dataset.Dataset.setList">
<code class="descname">setList</code><span class="sig-paren">(</span><em>path_list</em>, <em>set_name</em><span class="sig-paren">)</span><a class="headerlink" href="#Dataset.Dataset.setList" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a list of images which can contain all samples from the &#8216;train&#8217;, &#8216;val&#8217;, or
&#8216;test&#8217; sets (specified by set_name).
&#8216;path_list&#8217; can either be a path to a .txt file containing the paths to the images or a python list of paths</p>
</dd></dl>

<dl class="method">
<dt id="Dataset.Dataset.setListGeneral">
<code class="descname">setListGeneral</code><span class="sig-paren">(</span><em>path_list, split=[0.8, 0.1, 0.1], shuffle=True</em><span class="sig-paren">)</span><a class="headerlink" href="#Dataset.Dataset.setListGeneral" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a single list of images from which train/val/test divisions will be applied.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>path_list</strong> &#8211; path to the .txt file with the list of images.</li>
<li><strong>split</strong> &#8211; percentage of images used for [training, validation, test].</li>
<li><strong>shuffle</strong> &#8211; wether we are randomly shuffling the input samples or not.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Dataset.Dataset.setSilence">
<code class="descname">setSilence</code><span class="sig-paren">(</span><em>silence</em><span class="sig-paren">)</span><a class="headerlink" href="#Dataset.Dataset.setSilence" title="Permalink to this definition">¶</a></dt>
<dd><p>Changes the silence mode of the &#8216;Dataset&#8217; instance.</p>
</dd></dl>

<dl class="method">
<dt id="Dataset.Dataset.setTrainMean">
<code class="descname">setTrainMean</code><span class="sig-paren">(</span><em>mean_image</em>, <em>normalization=False</em><span class="sig-paren">)</span><a class="headerlink" href="#Dataset.Dataset.setTrainMean" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a pre-calculated training mean image, &#8216;mean_image&#8217; can either be:</p>
<ul class="simple">
<li>numpy.array (complete image)</li>
<li>list with a value per channel</li>
<li>string with the path to the stored image.</li>
</ul>
</dd></dl>

<dl class="method">
<dt id="Dataset.Dataset.shuffleTraining">
<code class="descname">shuffleTraining</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Dataset.Dataset.shuffleTraining" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a random shuffling to the training samples.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="Dataset.loadDataset">
<code class="descclassname">Dataset.</code><code class="descname">loadDataset</code><span class="sig-paren">(</span><em>dataset_path</em><span class="sig-paren">)</span><a class="headerlink" href="#Dataset.loadDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a previously saved Dataset object.</p>
</dd></dl>

<dl class="function">
<dt id="Dataset.saveDataset">
<code class="descclassname">Dataset.</code><code class="descname">saveDataset</code><span class="sig-paren">(</span><em>dataset</em>, <em>store_path</em><span class="sig-paren">)</span><a class="headerlink" href="#Dataset.saveDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves a backup of the current Dataset object.</p>
</dd></dl>

</div>
<div class="section" id="module-CNN_Model">
<span id="cnn-model-py"></span><h2>CNN_Model.py<a class="headerlink" href="#module-CNN_Model" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="CNN_Model.CNN_Model">
<em class="property">class </em><code class="descclassname">CNN_Model.</code><code class="descname">CNN_Model</code><span class="sig-paren">(</span><em>nOutput=1000, type='basic_model', silence=False, input_shape=[256, 256, 3], structure_path=None, weights_path=None, model_name=None, plots_path=None, models_path=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.CNN_Model" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Wrapper for Keras&#8217; models. It provides the following utilities:</dt>
<dd><ul class="first last simple">
<li>Training visualization module.</li>
<li>Set of already implemented CNNs for quick definition.</li>
<li>Easy layers re-definition for finetuning.</li>
<li>Model backups.</li>
<li>Easy to use training and test methods.</li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="CNN_Model.CNN_Model.Empty">
<code class="descname">Empty</code><span class="sig-paren">(</span><em>nOutput</em>, <em>input</em><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.CNN_Model.Empty" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates an empty CNN_Model (can be externally defined)</p>
</dd></dl>

<dl class="method">
<dt id="CNN_Model.CNN_Model.GAP">
<code class="descname">GAP</code><span class="sig-paren">(</span><em>nOutput</em>, <em>input</em><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.CNN_Model.GAP" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Creates a GAP network for object localization as described in the paper</dt>
<dd>Zhou B, Khosla A, Lapedriza A, Oliva A, Torralba A. 
Learning Deep Features for Discriminative Localization. 
arXiv preprint arXiv:1512.04150. 2015 Dec 14.</dd>
<dt>Outputs:</dt>
<dd>&#8216;GAP/softmax&#8217; output of the final softmax classification
&#8216;GAP/conv&#8217; output of the generated convolutional maps.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="CNN_Model.CNN_Model.Identity_Layer">
<code class="descname">Identity_Layer</code><span class="sig-paren">(</span><em>nOutput</em>, <em>input</em><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.CNN_Model.Identity_Layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds an dummy Identity_Layer, which should give as output the same as the input.
Only used for passing the output from a previous stage to the next (see Staged_Network).</p>
</dd></dl>

<dl class="method">
<dt id="CNN_Model.CNN_Model.One_vs_One">
<code class="descname">One_vs_One</code><span class="sig-paren">(</span><em>nOutput</em>, <em>input</em><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.CNN_Model.One_vs_One" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a simple One_vs_One network with 3 convolutional layers (useful for ECOC models).</p>
</dd></dl>

<dl class="method">
<dt id="CNN_Model.CNN_Model.One_vs_One_Inception">
<code class="descname">One_vs_One_Inception</code><span class="sig-paren">(</span><em>nOutput=2, input=[224, 224, 3]</em><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.CNN_Model.One_vs_One_Inception" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a simple One_vs_One_Inception network with 2 inception layers (useful for ECOC models).</p>
</dd></dl>

<dl class="method">
<dt id="CNN_Model.CNN_Model.One_vs_One_Inception_v2">
<code class="descname">One_vs_One_Inception_v2</code><span class="sig-paren">(</span><em>nOutput=2, input=[224, 224, 3]</em><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.CNN_Model.One_vs_One_Inception_v2" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a simple One_vs_One_Inception_v2 network with 2 inception layers (useful for ECOC models).</p>
</dd></dl>

<dl class="method">
<dt id="CNN_Model.CNN_Model.Union_Layer">
<code class="descname">Union_Layer</code><span class="sig-paren">(</span><em>nOutput</em>, <em>input</em><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.CNN_Model.Union_Layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Network with just a dropout and a softmax layers which is intended to serve as the final layer for an ECOC model</p>
</dd></dl>

<dl class="method">
<dt id="CNN_Model.CNN_Model.VGG_16">
<code class="descname">VGG_16</code><span class="sig-paren">(</span><em>nOutput</em>, <em>input</em><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.CNN_Model.VGG_16" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a VGG model with 16 layers.</p>
</dd></dl>

<dl class="method">
<dt id="CNN_Model.CNN_Model.VGG_16_PReLU">
<code class="descname">VGG_16_PReLU</code><span class="sig-paren">(</span><em>nOutput</em>, <em>input</em><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.CNN_Model.VGG_16_PReLU" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a VGG model with 16 layers and with PReLU activations.</p>
</dd></dl>

<dl class="method">
<dt id="CNN_Model.CNN_Model.basic_model">
<code class="descname">basic_model</code><span class="sig-paren">(</span><em>nOutput</em>, <em>input</em><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.CNN_Model.basic_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a basic CNN model.</p>
</dd></dl>

<dl class="method">
<dt id="CNN_Model.CNN_Model.checkParameters">
<code class="descname">checkParameters</code><span class="sig-paren">(</span><em>input_params</em>, <em>default_params</em><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.CNN_Model.checkParameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Validates a set of input parameters and uses the default ones if not specified.</p>
</dd></dl>

<dl class="method">
<dt id="CNN_Model.CNN_Model.log">
<code class="descname">log</code><span class="sig-paren">(</span><em>mode</em>, <em>data_type</em>, <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.CNN_Model.log" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores the train and val information for plotting the training progress.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>mode</strong> &#8211; &#8216;train&#8217;, or &#8216;val&#8217;</li>
<li><strong>data_type</strong> &#8211; &#8216;iteration&#8217;, &#8216;loss&#8217; or &#8216;accuracy&#8217;</li>
<li><strong>value</strong> &#8211; numerical value taken by the data_type</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CNN_Model.CNN_Model.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.CNN_Model.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the training progress information.</p>
</dd></dl>

<dl class="method">
<dt id="CNN_Model.CNN_Model.predictOnBatch">
<code class="descname">predictOnBatch</code><span class="sig-paren">(</span><em>X</em>, <em>in_name=None</em>, <em>out_name=None</em>, <em>expand=False</em><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.CNN_Model.predictOnBatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a forward pass and returns the predicted values.</p>
</dd></dl>

<dl class="method">
<dt id="CNN_Model.CNN_Model.removeInputs">
<code class="descname">removeInputs</code><span class="sig-paren">(</span><em>inputs_names</em><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.CNN_Model.removeInputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes the list of inputs whose names are passed by parameter from the current network.
This function is only valid for Graph models.</p>
</dd></dl>

<dl class="method">
<dt id="CNN_Model.CNN_Model.removeLayers">
<code class="descname">removeLayers</code><span class="sig-paren">(</span><em>layers_names</em><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.CNN_Model.removeLayers" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes the list of layers whose names are passed by parameter from the current network.
Function only valid for Graph models. Use self.replaceLastLayers(...) for Sequential models.</p>
</dd></dl>

<dl class="method">
<dt id="CNN_Model.CNN_Model.removeOutputs">
<code class="descname">removeOutputs</code><span class="sig-paren">(</span><em>outputs_names</em><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.CNN_Model.removeOutputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes the list of outputs whose names are passed by parameter from the current network.
This function is only valid for Graph models.</p>
</dd></dl>

<dl class="method">
<dt id="CNN_Model.CNN_Model.replaceLastLayers">
<code class="descname">replaceLastLayers</code><span class="sig-paren">(</span><em>num_remove</em>, <em>new_layers</em><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.CNN_Model.replaceLastLayers" title="Permalink to this definition">¶</a></dt>
<dd><p>Replaces the last &#8216;num_remove&#8217; layers in the model by the newly defined in &#8216;new_layers&#8217;.
Function only valid for Sequential models. Use self.removeLayers(...) for Graph models.</p>
</dd></dl>

<dl class="method">
<dt id="CNN_Model.CNN_Model.resumeTrainNet">
<code class="descname">resumeTrainNet</code><span class="sig-paren">(</span><em>ds</em>, <em>parameters</em>, <em>out_name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.CNN_Model.resumeTrainNet" title="Permalink to this definition">¶</a></dt>
<dd><p>Resumes the last training state of a stored model keeping also its training parameters. 
If we introduce any parameter through the argument &#8216;parameters&#8217;, it will be replaced by the old one.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>out_name</strong> &#8211; name of the output node that will be used to evaluate the network accuracy. Only applicable for Graph models.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CNN_Model.CNN_Model.setName">
<code class="descname">setName</code><span class="sig-paren">(</span><em>model_name</em>, <em>plots_path=None</em>, <em>models_path=None</em>, <em>clear_dirs=True</em><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.CNN_Model.setName" title="Permalink to this definition">¶</a></dt>
<dd><p>Changes the name (identifier) of the CNN_Model instance.</p>
</dd></dl>

<dl class="method">
<dt id="CNN_Model.CNN_Model.setOptimizer">
<code class="descname">setOptimizer</code><span class="sig-paren">(</span><em>lr=None</em>, <em>momentum=None</em>, <em>loss=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.CNN_Model.setOptimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets a new optimizer for the CNN model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>lr</strong> &#8211; learning rate of the network</li>
<li><strong>momentum</strong> &#8211; momentum of the network (if None, then momentum = 1-lr)</li>
<li><strong>loss</strong> &#8211; loss function applied for optimization</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CNN_Model.CNN_Model.testNet">
<code class="descname">testNet</code><span class="sig-paren">(</span><em>ds</em>, <em>parameters</em>, <em>out_name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.CNN_Model.testNet" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a complete round of tests using the test set in the provided Dataset instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>out_name</strong> &#8211; name of the output node that will be used to evaluate the network accuracy. Only applicable for Graph models.</td>
</tr>
</tbody>
</table>
<p>The available (optional) testing parameters are the following ones:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>batch_size</strong> &#8211; size of the batch (number of images) applied on each interation</td>
</tr>
</tbody>
</table>
<p>####    Data processing parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n_parallel_loaders</strong> &#8211; number of parallel data loaders allowed to work at the same time</li>
<li><strong>normalize_images</strong> &#8211; boolean indicating if we want to 0-1 normalize the image pixel values</li>
<li><strong>mean_substraction</strong> &#8211; boolean indicating if we want to substract the training mean</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CNN_Model.CNN_Model.testNetSamples">
<code class="descname">testNetSamples</code><span class="sig-paren">(</span><em>X</em>, <em>batch_size=50</em><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.CNN_Model.testNetSamples" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a forward pass on the samples provided and returns the predicted classes and probabilities.</p>
</dd></dl>

<dl class="method">
<dt id="CNN_Model.CNN_Model.testOnBatch">
<code class="descname">testOnBatch</code><span class="sig-paren">(</span><em>X</em>, <em>Y</em>, <em>accuracy=True</em>, <em>out_name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.CNN_Model.testOnBatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a test on the samples provided and returns the resulting loss and accuracy (if True).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>out_name</strong> &#8211; name of the output node that will be used to evaluate the network accuracy. Only applicable for Graph models.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="CNN_Model.CNN_Model.trainNet">
<code class="descname">trainNet</code><span class="sig-paren">(</span><em>ds</em>, <em>parameters</em>, <em>out_name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.CNN_Model.trainNet" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains the network on the given dataset &#8216;ds&#8217;. 
out_name: name of the output node that will be used to evaluate the network accuracy. Only applicable to Graph models.</p>
<p>The available (optional) training parameters are the following ones:</p>
<p>####    Visualization parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>report_iter</strong> &#8211; number of iterations between each loss report</li>
<li><strong>iter_for_val</strong> &#8211; number of interations between each validation test</li>
<li><strong>num_iterations_val</strong> &#8211; number of iterations applied on the validation dataset for computing the average performance (if None then all the validation data will be tested)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>####    Learning parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n_epochs</strong> &#8211; number of epochs that will be applied during training</li>
<li><strong>batch_size</strong> &#8211; size of the batch (number of images) applied on each interation by the SGD optimization</li>
<li><strong>lr_decay</strong> &#8211; number of iterations passed for decreasing the learning rate</li>
<li><strong>lr_gamma</strong> &#8211; proportion of learning rate kept at each decrease. It can also be a set of rules defined by a list, e.g. lr_gamma = [[3000, 0.9], ..., [None, 0.8]] means 0.9 until iteration 3000, ..., 0.8 until the end.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>####    Data processing parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n_parallel_loaders</strong> &#8211; number of parallel data loaders allowed to work at the same time</li>
<li><strong>normalize_images</strong> &#8211; boolean indicating if we want to 0-1 normalize the image pixel values</li>
<li><strong>mean_substraction</strong> &#8211; boolean indicating if we want to substract the training mean</li>
<li><strong>data_augmentation</strong> &#8211; boolean indicating if we want to perform data augmentation (always False on validation)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>####    Other parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>save_model</strong> &#8211; number of iterations between each model backup</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="CNN_Model.loadModel">
<code class="descclassname">CNN_Model.</code><code class="descname">loadModel</code><span class="sig-paren">(</span><em>model_path</em>, <em>iter</em><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.loadModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a previously saved CNN_Model object.</p>
</dd></dl>

<dl class="function">
<dt id="CNN_Model.saveModel">
<code class="descclassname">CNN_Model.</code><code class="descname">saveModel</code><span class="sig-paren">(</span><em>model_wrapper</em>, <em>iter</em>, <em>path=None</em><span class="sig-paren">)</span><a class="headerlink" href="#CNN_Model.saveModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves a backup of the current CNN_Model object after trained for &#8216;iter&#8217; iterations.</p>
</dd></dl>

</div>
<div class="section" id="module-Staged_Network">
<span id="staged-network-py"></span><h2>Staged_Network.py<a class="headerlink" href="#module-Staged_Network" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="Staged_Network.Staged_Network">
<em class="property">class </em><code class="descclassname">Staged_Network.</code><code class="descname">Staged_Network</code><span class="sig-paren">(</span><em>silence=False</em>, <em>model_name=None</em>, <em>plots_path=None</em>, <em>models_path=None</em><span class="sig-paren">)</span><a class="headerlink" href="#Staged_Network.Staged_Network" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds and manages a set of CNN_Model instances that will be trained and executed in ordered stages.</p>
<dl class="method">
<dt id="Staged_Network.Staged_Network.addBranch">
<code class="descname">addBranch</code><span class="sig-paren">(</span><em>branch</em>, <em>stage_id</em>, <em>axis=0</em>, <em>out_name=None</em>, <em>in_name=None</em>, <em>training_is_enabled=True</em>, <em>expand_dimensions=True</em>, <em>balanced=True</em><span class="sig-paren">)</span><a class="headerlink" href="#Staged_Network.Staged_Network.addBranch" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds a new branch to a specific stage.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>stage_id</strong> &#8211; id position of the stage where the new branch will be added.</li>
<li><strong>axis</strong> &#8211; indicates the axis where we want to apply the join of the outputs.</li>
<li><strong>out_name</strong> &#8211; name of the output node used for evaluation. If stage is a list, then we must provide a list of output identifiers. Only has to be specified for the Graph stages</li>
<li><strong>in_name</strong> &#8211; name of the previous stage output that will be used for propagation to the next stage. If stage is a list, then we must provide a list of output identifiers. Only has to be specified for the Graph stages</li>
<li><strong>training_is_enabled</strong> &#8211; indicates if the training is enabled for the input branches. If stage is a list, then input a list of booleans if only some branches&#8217; training will be enabled.</li>
<li><strong>expand_dimensions</strong> &#8211; indicates if we want to expand the dimensions (to 4) of the inputted data to this stage. If stage is a list, then input a list of booleans if only some branches&#8217; input dimensions will be expanded.</li>
<li><strong>balanced</strong> &#8211; indicates if we want to perform a balanced training (equal number of samples per class). If stage is a list, then input a list of booleans if only some branches will be trained in a balanced manner.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Staged_Network.Staged_Network.addStage">
<code class="descname">addStage</code><span class="sig-paren">(</span><em>stage</em>, <em>axis=0</em>, <em>out_name=None</em>, <em>in_name=None</em>, <em>reloading_model=False</em>, <em>training_is_enabled=True</em>, <em>expand_dimensions=True</em>, <em>balanced=True</em><span class="sig-paren">)</span><a class="headerlink" href="#Staged_Network.Staged_Network.addStage" title="Permalink to this definition">¶</a></dt>
<dd><p>Add either a Stage or CNN_Model object to the list of stages. 
If the current stage is a parallel stage, it must be a list of Stages and the parameter axis must be specified.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>stage</strong> &#8211; single Stage instance or multi-stage (parallalel) list of Stage instances.</li>
<li><strong>axis</strong> &#8211; indicates the axis where we want to apply the join of the outputs of all the branches in this stage. Only has to be specified for the parallel stages.</li>
<li><strong>out_name</strong> &#8211; name of the output node used for evaluation. If stage is a list, then we must provide a list of output identifiers. Only has to be specified for the Graph stages</li>
<li><strong>in_name</strong> &#8211; name of the previous stage output that will be used for propagation to the next stage. If stage is a list, then we must provide a list of output identifiers. Only has to be specified for the Graph stages</li>
<li><strong>reloading_model</strong> &#8211; only should be set to &#8216;True&#8217; when the Staged_Network model is being reloaded from memory</li>
<li><strong>training_is_enabled</strong> &#8211; indicates if the training is enabled for the current stage. If stage is a list, then input a list of booleans if only some branches&#8217; training will be enabled.</li>
<li><strong>expand_dimensions</strong> &#8211; indicates if we want to expand the dimensions (to 4) of the inputted data to this stage. If stage is a list, then input a list of booleans if only some branches&#8217; input dimensions will be expanded.</li>
<li><strong>balanced</strong> &#8211; indicates if we want to perform a balanced training (equal number of samples per class). If stage is a list, then input a list of booleans if only some branches will be trained in a balanced manner.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Staged_Network.Staged_Network.changeAllNames">
<code class="descname">changeAllNames</code><span class="sig-paren">(</span><em>model_name</em>, <em>clear_dirs=True</em><span class="sig-paren">)</span><a class="headerlink" href="#Staged_Network.Staged_Network.changeAllNames" title="Permalink to this definition">¶</a></dt>
<dd><p>Changes all the model names and plot/save locations from all the stages and braches in the current Staged_Network. 
Only the base &#8216;model_name&#8217; must be given, the standard stage/branch names, plot and model locations will be used.</p>
</dd></dl>

<dl class="method">
<dt id="Staged_Network.Staged_Network.checkParameters">
<code class="descname">checkParameters</code><span class="sig-paren">(</span><em>input_params</em>, <em>default_params</em><span class="sig-paren">)</span><a class="headerlink" href="#Staged_Network.Staged_Network.checkParameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Validates a set of input parameters and uses the default ones if not specified.</p>
</dd></dl>

<dl class="method">
<dt id="Staged_Network.Staged_Network.enableTraining">
<code class="descname">enableTraining</code><span class="sig-paren">(</span><em>stage_id</em>, <em>training_is_enabled</em><span class="sig-paren">)</span><a class="headerlink" href="#Staged_Network.Staged_Network.enableTraining" title="Permalink to this definition">¶</a></dt>
<dd><p>Replaces the trainingIsEnabled list from the selected stage.</p>
</dd></dl>

<dl class="method">
<dt id="Staged_Network.Staged_Network.forwardUntilStage">
<code class="descname">forwardUntilStage</code><span class="sig-paren">(</span><em>X</em>, <em>stage_id</em><span class="sig-paren">)</span><a class="headerlink" href="#Staged_Network.Staged_Network.forwardUntilStage" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a forward pass on all the stages until &#8216;stage_id&#8217; (not included).</p>
</dd></dl>

<dl class="method">
<dt id="Staged_Network.Staged_Network.getJoinOnAxis">
<code class="descname">getJoinOnAxis</code><span class="sig-paren">(</span><em>position</em><span class="sig-paren">)</span><a class="headerlink" href="#Staged_Network.Staged_Network.getJoinOnAxis" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the axis on a certain position.</p>
</dd></dl>

<dl class="method">
<dt id="Staged_Network.Staged_Network.getNumStages">
<code class="descname">getNumStages</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Staged_Network.Staged_Network.getNumStages" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the current number of defined Stages.</p>
</dd></dl>

<dl class="method">
<dt id="Staged_Network.Staged_Network.getStage">
<code class="descname">getStage</code><span class="sig-paren">(</span><em>position</em><span class="sig-paren">)</span><a class="headerlink" href="#Staged_Network.Staged_Network.getStage" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the Stage object on a certain position.</p>
</dd></dl>

<dl class="method">
<dt id="Staged_Network.Staged_Network.popStage">
<code class="descname">popStage</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Staged_Network.Staged_Network.popStage" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes the last stage on a Staged_Network</p>
</dd></dl>

<dl class="method">
<dt id="Staged_Network.Staged_Network.predictClassesOnBatch">
<code class="descname">predictClassesOnBatch</code><span class="sig-paren">(</span><em>X</em>, <em>topN=5</em><span class="sig-paren">)</span><a class="headerlink" href="#Staged_Network.Staged_Network.predictClassesOnBatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a forward pass along all the Staged_Network and returns the topN predicted classes sorted.</p>
</dd></dl>

<dl class="method">
<dt id="Staged_Network.Staged_Network.predictOnBatch">
<code class="descname">predictOnBatch</code><span class="sig-paren">(</span><em>X</em><span class="sig-paren">)</span><a class="headerlink" href="#Staged_Network.Staged_Network.predictOnBatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a forward pass along all the Staged_Network and returns the predicted values.</p>
</dd></dl>

<dl class="method">
<dt id="Staged_Network.Staged_Network.removeBranches">
<code class="descname">removeBranches</code><span class="sig-paren">(</span><em>branch_ids</em>, <em>stage_id</em><span class="sig-paren">)</span><a class="headerlink" href="#Staged_Network.Staged_Network.removeBranches" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes a specific set of branches from a specific stage.</p>
</dd></dl>

<dl class="method">
<dt id="Staged_Network.Staged_Network.removeWorseClassifiers">
<code class="descname">removeWorseClassifiers</code><span class="sig-paren">(</span><em>ds</em>, <em>stage_id</em>, <em>min_accuracy=0.7</em>, <em>parameters={}</em><span class="sig-paren">)</span><a class="headerlink" href="#Staged_Network.Staged_Network.removeWorseClassifiers" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a complete round of tests using the validation (&#8216;val&#8217;) set in the provided Dataset instance for finding the set
of recently trained classifiers in &#8216;stage_id&#8217; that have not been properly trained. If they do not accomplish a minimum 
accuracy &#8216;min_accuracy&#8217; they are removed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>batch_size</strong> &#8211; size of the batch (number of images) applied on each interation</td>
</tr>
</tbody>
</table>
<p>####    Data processing parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n_parallel_loaders</strong> &#8211; number of parallel data loaders allowed to work at the same time</li>
<li><strong>normalize_images</strong> &#8211; boolean indicating if we want to 0-1 normalize the image pixel values</li>
<li><strong>mean_substraction</strong> &#8211; boolean indicating if we want to substract the training mean</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Staged_Network.Staged_Network.replaceStage">
<code class="descname">replaceStage</code><span class="sig-paren">(</span><em>stage</em>, <em>position</em><span class="sig-paren">)</span><a class="headerlink" href="#Staged_Network.Staged_Network.replaceStage" title="Permalink to this definition">¶</a></dt>
<dd><p>Replaces a Stage object on a certain position</p>
</dd></dl>

<dl class="method">
<dt id="Staged_Network.Staged_Network.resumeTrainNet">
<code class="descname">resumeTrainNet</code><span class="sig-paren">(</span><em>ds</em>, <em>stage_id</em>, <em>parameters={}</em><span class="sig-paren">)</span><a class="headerlink" href="#Staged_Network.Staged_Network.resumeTrainNet" title="Permalink to this definition">¶</a></dt>
<dd><p>Resumes the last training state of a stored stage keeping also its training parameters. 
If we introduce any parameter through the argument &#8216;parameters&#8217;, it will be replaced by the old one.</p>
</dd></dl>

<dl class="method">
<dt id="Staged_Network.Staged_Network.setName">
<code class="descname">setName</code><span class="sig-paren">(</span><em>model_name</em>, <em>plots_path=None</em>, <em>models_path=None</em>, <em>clear_dirs=True</em><span class="sig-paren">)</span><a class="headerlink" href="#Staged_Network.Staged_Network.setName" title="Permalink to this definition">¶</a></dt>
<dd><p>Changes the name (identifier) of the Staged_Network instance.</p>
</dd></dl>

<dl class="method">
<dt id="Staged_Network.Staged_Network.testNet">
<code class="descname">testNet</code><span class="sig-paren">(</span><em>ds</em>, <em>stage_id=None</em>, <em>parameters={}</em><span class="sig-paren">)</span><a class="headerlink" href="#Staged_Network.Staged_Network.testNet" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a complete round of tests using the test set in the provided Dataset instance. 
If stage_id=None the test will be applied on the whole staged network.
The available (optional) testing parameters are the following ones:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>batch_size</strong> &#8211; size of the batch (number of images) applied on each interation</td>
</tr>
</tbody>
</table>
<p>####    Data processing parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n_parallel_loaders</strong> &#8211; number of parallel data loaders allowed to work at the same time</li>
<li><strong>normalize_images</strong> &#8211; boolean indicating if we want to 0-1 normalize the image pixel values</li>
<li><strong>mean_substraction</strong> &#8211; boolean indicating if we want to substract the training mean</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Staged_Network.Staged_Network.trainNet">
<code class="descname">trainNet</code><span class="sig-paren">(</span><em>ds</em>, <em>stage_id</em>, <em>parameters={}</em><span class="sig-paren">)</span><a class="headerlink" href="#Staged_Network.Staged_Network.trainNet" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains stage defined by stage_id on the given dataset &#8216;ds&#8217;. 
The available (optional) training parameters are the following ones:</p>
<p>####    Visualization parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>report_iter</strong> &#8211; number of iterations between each loss report</li>
<li><strong>iter_for_val</strong> &#8211; number of interations between each validation test</li>
<li><strong>num_iterations_val</strong> &#8211; number of iterations applied on the validation dataset for computing the average performance (if None then all the validation data will be tested)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>####    Learning parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n_epochs</strong> &#8211; number of epochs that will be applied during training</li>
<li><strong>batch_size</strong> &#8211; size of the batch (number of images) applied on each interation by the SGD optimization</li>
<li><strong>lr_decay</strong> &#8211; number of iterations passed for decreasing the learning rate</li>
<li><strong>lr_gamma</strong> &#8211; proportion of learning rate kept at each decrease.  It can also be a set of rules defined by a list, e.g. lr_gamma = [[3000, 0.9], ..., [None, 0.8]] means 0.9 until iteration 3000, ..., 0.8 until the end.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>####    Data processing parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n_parallel_loaders</strong> &#8211; number of parallel data loaders allowed to work at the same time</li>
<li><strong>normalize_images</strong> &#8211; boolean indicating if we want to 0-1 normalize the image pixel values</li>
<li><strong>mean_substraction</strong> &#8211; boolean indicating if we want to substract the training mean</li>
<li><strong>data_augmentation</strong> &#8211; boolean indicating if we want to perform data augmentation (always False on validation)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>####    Other parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>save_model</strong> &#8211; number of iterations between each model backup</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Staged_Network.Staged_Network.valWorsePairs">
<code class="descname">valWorsePairs</code><span class="sig-paren">(</span><em>ds</em>, <em>n_pairs=5</em>, <em>parameters={}</em>, <em>avoid_pairs=[]</em><span class="sig-paren">)</span><a class="headerlink" href="#Staged_Network.Staged_Network.valWorsePairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a complete round of tests using the validation (&#8216;val&#8217;) set in the provided Dataset instance for finding the set
of &#8216;n_pairs&#8217; pairs of classes that have a higher intra-error. The set of pairs of classes provided as tuples (#classA, #classB)
will not be selected.
The available (optional) testing parameters are the following ones:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>batch_size</strong> &#8211; size of the batch (number of images) applied on each interation</td>
</tr>
</tbody>
</table>
<p>####    Data processing parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n_parallel_loaders</strong> &#8211; number of parallel data loaders allowed to work at the same time</li>
<li><strong>normalize_images</strong> &#8211; boolean indicating if we want to 0-1 normalize the image pixel values</li>
<li><strong>mean_substraction</strong> &#8211; boolean indicating if we want to substract the training mean</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="Staged_Network.loadStagedModel">
<code class="descclassname">Staged_Network.</code><code class="descname">loadStagedModel</code><span class="sig-paren">(</span><em>model_path</em><span class="sig-paren">)</span><a class="headerlink" href="#Staged_Network.loadStagedModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a previously saved Staged_Network object.</p>
</dd></dl>

<dl class="function">
<dt id="Staged_Network.saveStagedModel">
<code class="descclassname">Staged_Network.</code><code class="descname">saveStagedModel</code><span class="sig-paren">(</span><em>staged_network</em>, <em>path=None</em><span class="sig-paren">)</span><a class="headerlink" href="#Staged_Network.saveStagedModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves a backup of the current Staged_Network object.</p>
</dd></dl>

</div>
<div class="section" id="module-Stage">
<span id="stage-py"></span><h2>Stage.py<a class="headerlink" href="#module-Stage" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="Stage.Stage">
<em class="property">class </em><code class="descclassname">Stage.</code><code class="descname">Stage</code><span class="sig-paren">(</span><em>nInput</em>, <em>nOutput</em>, <em>input_shape</em>, <em>output_shape</em>, <em>type='basic_model'</em>, <em>silence=False</em>, <em>structure_path=None</em>, <em>weights_path=None</em>, <em>model_name=None</em>, <em>plots_path=None</em>, <em>models_path=None</em><span class="sig-paren">)</span><a class="headerlink" href="#Stage.Stage" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for defining a single stage from a Staged_Network. 
This class is only intended to be used in conjunction with the Staged_Network class.</p>
<dl class="method">
<dt id="Stage.Stage.applyClassMapping">
<code class="descname">applyClassMapping</code><span class="sig-paren">(</span><em>Y</em><span class="sig-paren">)</span><a class="headerlink" href="#Stage.Stage.applyClassMapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the corresponding integer identifiers for the current Stage&#8217;s mapping given a set of categorical arrays Y.</p>
</dd></dl>

<dl class="method">
<dt id="Stage.Stage.applyMask">
<code class="descname">applyMask</code><span class="sig-paren">(</span><em>prediction</em><span class="sig-paren">)</span><a class="headerlink" href="#Stage.Stage.applyMask" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a prediction matrix after applying the defined output mask.</p>
</dd></dl>

<dl class="method">
<dt id="Stage.Stage.defineClassMapping">
<code class="descname">defineClassMapping</code><span class="sig-paren">(</span><em>mapping</em><span class="sig-paren">)</span><a class="headerlink" href="#Stage.Stage.defineClassMapping" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines an input mapping from all the classes available in a Staged_Network to the ones used in this particular Stage instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mapping</strong> &#8211; dictionary with all the classes in the Staged_Network as &#8216;keys&#8217; and the corresponding mapped inputs to this Stage as &#8216;values&#8217;. If some &#8216;key&#8217; is not used, its &#8216;value&#8217; should be set to None.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Stage.Stage.defineOutputMask">
<code class="descname">defineOutputMask</code><span class="sig-paren">(</span><em>mask</em><span class="sig-paren">)</span><a class="headerlink" href="#Stage.Stage.defineOutputMask" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines an output mask for redirecting this stage&#8217;s output to the following stage once this stage has been trained (on test mode).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mask</strong> &#8211; dictionary with all the Stage&#8217;s output values indices as &#8216;keys&#8217; and the corresponding mapped indices on the final test&#8217;s output as &#8216;values&#8217;. If some &#8216;key&#8217; is not used, its &#8216;value&#8217; should be set to None. E.g. if we have output_shape = [1,1] then mask = {&#8216;[0]&#8217;: [0], &#8216;[1]&#8217;: None} If we want to disable the mask, we can set it to None. The mask is disabled by default.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Stage.Stage.isReadyToTrainOnBatch">
<code class="descname">isReadyToTrainOnBatch</code><span class="sig-paren">(</span><em>batch_size</em>, <em>balanced</em><span class="sig-paren">)</span><a class="headerlink" href="#Stage.Stage.isReadyToTrainOnBatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the input samples lists have enough samples to train on a batch. 
In this case returns the first &#8216;batch_size&#8217; samples, else returns False.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>batch_size</strong> &#8211; number of samples retrieved for the next training batch</li>
<li><strong>balanced</strong> &#8211; wether we want a set of balanced samples or not</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Stage.Stage.predictOnBatch">
<code class="descname">predictOnBatch</code><span class="sig-paren">(</span><em>X</em>, <em>in_name=None</em>, <em>out_name=None</em>, <em>expand=False</em><span class="sig-paren">)</span><a class="headerlink" href="#Stage.Stage.predictOnBatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a forward pass and returns the predicted values after being processed by the output mask.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>in_name</strong> &#8211; name of the input we are asking for (from the previous stage). Only applicable to Graph models.</li>
<li><strong>out_name</strong> &#8211; name of the output used for prediction (from the current stage).</li>
<li><strong>expand</strong> &#8211; indicates if we want to expand the input dimensions to 4</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Stage.Stage.testOnBatch">
<code class="descname">testOnBatch</code><span class="sig-paren">(</span><em>X</em>, <em>Y</em>, <em>accuracy=True</em>, <em>out_name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#Stage.Stage.testOnBatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a test on the samples provided and returns the resulting loss and accuracy (if True).
It selects only the samples that are valid for the current Stage (self.mapping[labels] != None).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>out_name</strong> &#8211; name of the output we are asking for. Only applicable to Graph models.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Stage.Stage.trainOnBatch">
<code class="descname">trainOnBatch</code><span class="sig-paren">(</span><em>X</em>, <em>Y</em>, <em>batch_size</em>, <em>balanced=True</em>, <em>out_name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#Stage.Stage.trainOnBatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains the current stage on the last &#8216;batch_size&#8217; samples received. It makes sure the mapping of the
introduced samples is balanced among all the defined classes. If it isn&#8217;t it keeps storing them for
a latter forward-backward pass.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>X</strong> &#8211; numpy array with a set of loaded images ready to use for Keras</li>
<li><strong>Y</strong> &#8211; numpy array with a set of categorical labels ready to use for keras</li>
<li><strong>batch_size</strong> &#8211; number of samples that we want to use to train on the next batch</li>
<li><strong>balanced</strong> &#8211; indicates if we want to train on a set of balanced samples (same number of samples from each class)</li>
<li><strong>out_name</strong> &#8211; name of the output node that will be used to evaluate the network accuracy. Only applicable for Graph models.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Stage.Stage.trainOnBatch_DEPRECATED_class_weight">
<code class="descname">trainOnBatch_DEPRECATED_class_weight</code><span class="sig-paren">(</span><em>X</em>, <em>Y</em>, <em>batch_size</em>, <em>balanced=True</em>, <em>out_name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#Stage.Stage.trainOnBatch_DEPRECATED_class_weight" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains the current stage on the last &#8216;batch_size&#8217; samples received. It makes sure the mapping of the
introduced samples is balanced among all the defined classes. If it isn&#8217;t it keeps storing them for
a latter forward-backward pass.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>X</strong> &#8211; numpy array with a set of loaded images ready to use for Keras</li>
<li><strong>Y</strong> &#8211; numpy array with a set of categorical labels ready to use for keras</li>
<li><strong>batch_size</strong> &#8211; number of samples that we want to use to train on the next batch</li>
<li><strong>balanced</strong> &#8211; indicates if we want to train on a set of balanced samples (same number of samples from each class)</li>
<li><strong>out_name</strong> &#8211; name of the output node that will be used to evaluate the network accuracy. Only applicable for Graph models.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="Stage.Stage.trainOnBatch_DEPRECATED_lists">
<code class="descname">trainOnBatch_DEPRECATED_lists</code><span class="sig-paren">(</span><em>X</em>, <em>Y</em>, <em>batch_size</em>, <em>balanced=True</em>, <em>out_name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#Stage.Stage.trainOnBatch_DEPRECATED_lists" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains the current stage on the last &#8216;batch_size&#8217; samples received. It makes sure the mapping of the
introduced samples is balanced among all the defined classes. If it isn&#8217;t it keeps storing them for
a latter forward-backward pass.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>X</strong> &#8211; numpy array with a set of loaded images ready to use for Keras</li>
<li><strong>Y</strong> &#8211; numpy array with a set of categorical labels ready to use for keras</li>
<li><strong>batch_size</strong> &#8211; number of samples that we want to use to train on the next batch</li>
<li><strong>balanced</strong> &#8211; indicates if we want to train on a set of balanced samples (same number of samples from each class)</li>
<li><strong>out_name</strong> &#8211; name of the output node that will be used to evaluate the network accuracy. Only applicable for Graph models.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-ECOC_Classifier">
<span id="ecoc-classifier-py"></span><h2>ECOC_Classifier.py<a class="headerlink" href="#module-ECOC_Classifier" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ECOC_Classifier.ECOC_Classifier">
<em class="property">class </em><code class="descclassname">ECOC_Classifier.</code><code class="descname">ECOC_Classifier</code><span class="sig-paren">(</span><em>table</em>, <em>distance='hamming'</em><span class="sig-paren">)</span><a class="headerlink" href="#ECOC_Classifier.ECOC_Classifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for defining a classical ECOC classifier.</p>
<dl class="method">
<dt id="ECOC_Classifier.ECOC_Classifier.append">
<code class="descname">append</code><span class="sig-paren">(</span><em>rows</em><span class="sig-paren">)</span><a class="headerlink" href="#ECOC_Classifier.ECOC_Classifier.append" title="Permalink to this definition">¶</a></dt>
<dd><p>Appends new rows to the ECOC table which will define the code for new classifiers.</p>
</dd></dl>

<dl class="method">
<dt id="ECOC_Classifier.ECOC_Classifier.dist2sim">
<code class="descname">dist2sim</code><span class="sig-paren">(</span><em>dist</em><span class="sig-paren">)</span><a class="headerlink" href="#ECOC_Classifier.ECOC_Classifier.dist2sim" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a set of distances into similarities</p>
</dd></dl>

<dl class="method">
<dt id="ECOC_Classifier.ECOC_Classifier.hammingDistance">
<code class="descname">hammingDistance</code><span class="sig-paren">(</span><em>X</em><span class="sig-paren">)</span><a class="headerlink" href="#ECOC_Classifier.ECOC_Classifier.hammingDistance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a matrix of dimensions (n_samples, n_classes) with the distance of each sample to each class.</p>
</dd></dl>

<dl class="method">
<dt id="ECOC_Classifier.ECOC_Classifier.predictOnBatch">
<code class="descname">predictOnBatch</code><span class="sig-paren">(</span><em>X</em>, <em>in_name=None</em>, <em>out_name=None</em>, <em>expand=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ECOC_Classifier.ECOC_Classifier.predictOnBatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Predicts the classes for a set of samples.</p>
</dd></dl>

<dl class="method">
<dt id="ECOC_Classifier.ECOC_Classifier.setDistance">
<code class="descname">setDistance</code><span class="sig-paren">(</span><em>distance</em><span class="sig-paren">)</span><a class="headerlink" href="#ECOC_Classifier.ECOC_Classifier.setDistance" title="Permalink to this definition">¶</a></dt>
<dd><p>Changes the kind of distance used for computing the predictions.</p>
</dd></dl>

<dl class="method">
<dt id="ECOC_Classifier.ECOC_Classifier.softmax">
<code class="descname">softmax</code><span class="sig-paren">(</span><em>similarities</em><span class="sig-paren">)</span><a class="headerlink" href="#ECOC_Classifier.ECOC_Classifier.softmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies the softmax function to a set of similarities for obtaining a normalized vector of probabilities.</p>
</dd></dl>

<dl class="method">
<dt id="ECOC_Classifier.ECOC_Classifier.testOnBatch">
<code class="descname">testOnBatch</code><span class="sig-paren">(</span><em>X</em>, <em>Y</em>, <em>accuracy=True</em>, <em>out_name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ECOC_Classifier.ECOC_Classifier.testOnBatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies a test on the samples provided and returns the resulting loss and accuracy (if True).</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-Utils">
<span id="utils-py"></span><h2>Utils.py<a class="headerlink" href="#module-Utils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="Utils.prepareGoogleNet_Food101">
<code class="descclassname">Utils.</code><code class="descname">prepareGoogleNet_Food101</code><span class="sig-paren">(</span><em>model_wrapper</em><span class="sig-paren">)</span><a class="headerlink" href="#Utils.prepareGoogleNet_Food101" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepares the GoogleNet model after its conversion from Caffe</p>
</dd></dl>

<dl class="function">
<dt id="Utils.prepareGoogleNet_Food101_Stage1">
<code class="descclassname">Utils.</code><code class="descname">prepareGoogleNet_Food101_Stage1</code><span class="sig-paren">(</span><em>model_wrapper</em><span class="sig-paren">)</span><a class="headerlink" href="#Utils.prepareGoogleNet_Food101_Stage1" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepares the GoogleNet model for serving as the first Stage of a Staged_Netork</p>
</dd></dl>

<dl class="function">
<dt id="Utils.prepareGoogleNet_Stage2">
<code class="descclassname">Utils.</code><code class="descname">prepareGoogleNet_Stage2</code><span class="sig-paren">(</span><em>stage1</em>, <em>stage2</em><span class="sig-paren">)</span><a class="headerlink" href="#Utils.prepareGoogleNet_Stage2" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes the second part of the GoogleNet for inserting it into the second stage.</p>
</dd></dl>

</div>
<div class="section" id="module-ThreadLoader">
<span id="threadloader-py"></span><h2>ThreadLoader.py<a class="headerlink" href="#module-ThreadLoader" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="ThreadLoader.ThreadDataLoader">
<em class="property">class </em><code class="descclassname">ThreadLoader.</code><code class="descname">ThreadDataLoader</code><span class="sig-paren">(</span><em>target</em>, <em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#ThreadLoader.ThreadDataLoader" title="Permalink to this definition">¶</a></dt>
<dd><p>Data loader based on threads (parallel execution)</p>
</dd></dl>

<dl class="class">
<dt id="ThreadLoader.ThreadModelLoader">
<em class="property">class </em><code class="descclassname">ThreadLoader.</code><code class="descname">ThreadModelLoader</code><span class="sig-paren">(</span><em>target</em>, <em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#ThreadLoader.ThreadModelLoader" title="Permalink to this definition">¶</a></dt>
<dd><p>Model loader based on threads (parallel execution)</p>
</dd></dl>

<dl class="function">
<dt id="ThreadLoader.retrieveModel">
<code class="descclassname">ThreadLoader.</code><code class="descname">retrieveModel</code><span class="sig-paren">(</span><em>path_json</em>, <em>path_h5</em>, <em>path_pkl</em><span class="sig-paren">)</span><a class="headerlink" href="#ThreadLoader.retrieveModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a model using a parallel thread.</p>
</dd></dl>

<dl class="function">
<dt id="ThreadLoader.retrieveXY">
<code class="descclassname">ThreadLoader.</code><code class="descname">retrieveXY</code><span class="sig-paren">(</span><em>dataset</em>, <em>set_name</em>, <em>batchSize</em>, <em>normalization</em>, <em>meanSubstraction</em>, <em>dataAugmentation</em><span class="sig-paren">)</span><a class="headerlink" href="#ThreadLoader.retrieveXY" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieves a set of samples from the given dataset and the given set name</p>
</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="index.html" class="btn btn-neutral" title="Welcome to Staged Keras Wrapper’s documentation!" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Marc Bolaños.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>